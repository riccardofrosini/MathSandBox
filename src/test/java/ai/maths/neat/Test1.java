package ai.maths.neat;

import ai.maths.neat.neuralnetwork.GenomeSerializerDeserializer;
import ai.maths.neat.neuralnetwork.functions.GenomeEvaluator;
import ai.maths.neat.utils.NodeFunctionsCreator;
import ai.maths.tictactoe.TicTacToe;
import org.junit.Test;

public class Test1 {

    @Test
    public void test() {
        GenomeEvaluator geno = GenomeSerializerDeserializer.getEvaluatorFromJson("[{\"inputId\":0,\"id\":1,\"type\":\"INPUT\",\"backConnections\":[]},{\"inputId\":1,\"id\":2,\"type\":\"INPUT\",\"backConnections\":[]},{\"inputId\":2,\"id\":3,\"type\":\"INPUT\",\"backConnections\":[]},{\"inputId\":3,\"id\":4,\"type\":\"INPUT\",\"backConnections\":[]},{\"inputId\":4,\"id\":5,\"type\":\"INPUT\",\"backConnections\":[]},{\"inputId\":5,\"id\":6,\"type\":\"INPUT\",\"backConnections\":[]},{\"inputId\":6,\"id\":7,\"type\":\"INPUT\",\"backConnections\":[]},{\"inputId\":7,\"id\":8,\"type\":\"INPUT\",\"backConnections\":[]},{\"inputId\":8,\"id\":9,\"type\":\"INPUT\",\"backConnections\":[]},{\"inputId\":9,\"id\":10,\"type\":\"INPUT\",\"backConnections\":[]},{\"inputId\":10,\"id\":11,\"type\":\"INPUT\",\"backConnections\":[]},{\"inputId\":11,\"id\":12,\"type\":\"INPUT\",\"backConnections\":[]},{\"inputId\":12,\"id\":13,\"type\":\"INPUT\",\"backConnections\":[]},{\"inputId\":13,\"id\":14,\"type\":\"INPUT\",\"backConnections\":[]},{\"inputId\":14,\"id\":15,\"type\":\"INPUT\",\"backConnections\":[]},{\"inputId\":15,\"id\":16,\"type\":\"INPUT\",\"backConnections\":[]},{\"inputId\":16,\"id\":17,\"type\":\"INPUT\",\"backConnections\":[]},{\"inputId\":17,\"id\":18,\"type\":\"INPUT\",\"backConnections\":[]},{\"inputId\":18,\"id\":19,\"type\":\"INPUT\",\"backConnections\":[]},{\"inputId\":19,\"id\":20,\"type\":\"INPUT\",\"backConnections\":[]},{\"inputId\":20,\"id\":21,\"type\":\"INPUT\",\"backConnections\":[]},{\"inputId\":21,\"id\":22,\"type\":\"INPUT\",\"backConnections\":[]},{\"inputId\":22,\"id\":23,\"type\":\"INPUT\",\"backConnections\":[]},{\"inputId\":23,\"id\":24,\"type\":\"INPUT\",\"backConnections\":[]},{\"inputId\":24,\"id\":25,\"type\":\"INPUT\",\"backConnections\":[]},{\"inputId\":25,\"id\":26,\"type\":\"INPUT\",\"backConnections\":[]},{\"inputId\":26,\"id\":27,\"type\":\"INPUT\",\"backConnections\":[]},{\"inputId\":0,\"id\":28,\"type\":\"OUTPUT\",\"backConnections\":[{\"inNode\":1,\"outNode\":28,\"innovation\":280001,\"weight\":0.07249320947437501,\"enabled\":false},{\"inNode\":4,\"outNode\":28,\"innovation\":280004,\"weight\":-0.7393783025841422,\"enabled\":false},{\"inNode\":6,\"outNode\":28,\"innovation\":280006,\"weight\":-0.9750286868107934,\"enabled\":false},{\"inNode\":11,\"outNode\":28,\"innovation\":280011,\"weight\":-0.6745058778999096,\"enabled\":false},{\"inNode\":12,\"outNode\":28,\"innovation\":280012,\"weight\":-0.275991527152876,\"enabled\":false},{\"inNode\":27,\"outNode\":28,\"innovation\":280027,\"weight\":0.8036313493089209,\"enabled\":false}]},{\"inputId\":0,\"id\":29,\"type\":\"OUTPUT\",\"backConnections\":[{\"inNode\":1,\"outNode\":29,\"innovation\":290001,\"weight\":0.2493366158982741,\"enabled\":false},{\"inNode\":4,\"outNode\":29,\"innovation\":290004,\"weight\":0.36838615437996297,\"enabled\":true},{\"inNode\":7,\"outNode\":29,\"innovation\":290007,\"weight\":0.5121073040596693,\"enabled\":true},{\"inNode\":8,\"outNode\":29,\"innovation\":290008,\"weight\":0.07980098040921324,\"enabled\":false},{\"inNode\":12,\"outNode\":29,\"innovation\":290012,\"weight\":-0.005608363307860423,\"enabled\":false},{\"inNode\":15,\"outNode\":29,\"innovation\":290015,\"weight\":-0.073216362958498,\"enabled\":true}]},{\"inputId\":0,\"id\":30,\"type\":\"OUTPUT\",\"backConnections\":[{\"inNode\":7,\"outNode\":30,\"innovation\":300007,\"weight\":0.8740408162450525,\"enabled\":true},{\"inNode\":12,\"outNode\":30,\"innovation\":300012,\"weight\":0.7015887402011518,\"enabled\":false},{\"inNode\":25,\"outNode\":30,\"innovation\":300025,\"weight\":0.06286957719592584,\"enabled\":false},{\"inNode\":27,\"outNode\":30,\"innovation\":300027,\"weight\":0.7127864766257969,\"enabled\":false}]},{\"inputId\":0,\"id\":31,\"type\":\"OUTPUT\",\"backConnections\":[{\"inNode\":2,\"outNode\":31,\"innovation\":310002,\"weight\":0.3279741211624641,\"enabled\":false},{\"inNode\":10,\"outNode\":31,\"innovation\":310010,\"weight\":0.8085575789536623,\"enabled\":true},{\"inNode\":11,\"outNode\":31,\"innovation\":310011,\"weight\":-0.6756041100159453,\"enabled\":false},{\"inNode\":14,\"outNode\":31,\"innovation\":310014,\"weight\":-0.959344582455864,\"enabled\":false},{\"inNode\":16,\"outNode\":31,\"innovation\":310016,\"weight\":-0.48780200839243537,\"enabled\":false},{\"inNode\":19,\"outNode\":31,\"innovation\":310019,\"weight\":0.6728164006628937,\"enabled\":false},{\"inNode\":21,\"outNode\":31,\"innovation\":310021,\"weight\":-0.7925270826389289,\"enabled\":false},{\"inNode\":22,\"outNode\":31,\"innovation\":310022,\"weight\":-0.6291058761571139,\"enabled\":false},{\"inNode\":24,\"outNode\":31,\"innovation\":310024,\"weight\":-0.09603799934510474,\"enabled\":false}]},{\"inputId\":0,\"id\":32,\"type\":\"OUTPUT\",\"backConnections\":[{\"inNode\":11,\"outNode\":32,\"innovation\":320011,\"weight\":-0.9814260662062655,\"enabled\":false},{\"inNode\":12,\"outNode\":32,\"innovation\":320012,\"weight\":-0.028817540953383774,\"enabled\":false},{\"inNode\":13,\"outNode\":32,\"innovation\":320013,\"weight\":0.959431502986458,\"enabled\":true},{\"inNode\":19,\"outNode\":32,\"innovation\":320019,\"weight\":0.6812679303005934,\"enabled\":false},{\"inNode\":23,\"outNode\":32,\"innovation\":320023,\"weight\":0.9738479094400458,\"enabled\":false},{\"inNode\":26,\"outNode\":32,\"innovation\":320026,\"weight\":0.2918894548554441,\"enabled\":false}]},{\"inputId\":0,\"id\":33,\"type\":\"OUTPUT\",\"backConnections\":[{\"inNode\":1,\"outNode\":33,\"innovation\":330001,\"weight\":0.3767446354452862,\"enabled\":false},{\"inNode\":16,\"outNode\":33,\"innovation\":330016,\"weight\":0.8732575626623266,\"enabled\":true}]},{\"inputId\":0,\"id\":34,\"type\":\"OUTPUT\",\"backConnections\":[{\"inNode\":5,\"outNode\":34,\"innovation\":340005,\"weight\":0.5245291167925683,\"enabled\":false},{\"inNode\":15,\"outNode\":34,\"innovation\":340015,\"weight\":0.9204643773467206,\"enabled\":false},{\"inNode\":18,\"outNode\":34,\"innovation\":340018,\"weight\":-0.6281371927789599,\"enabled\":false},{\"inNode\":19,\"outNode\":34,\"innovation\":340019,\"weight\":0.9467765572536881,\"enabled\":true},{\"inNode\":20,\"outNode\":34,\"innovation\":340020,\"weight\":-0.6647019157111775,\"enabled\":false}]},{\"inputId\":0,\"id\":35,\"type\":\"OUTPUT\",\"backConnections\":[{\"inNode\":5,\"outNode\":35,\"innovation\":350005,\"weight\":0.4352915811627698,\"enabled\":false},{\"inNode\":8,\"outNode\":35,\"innovation\":350008,\"weight\":-0.8070642537374463,\"enabled\":false},{\"inNode\":9,\"outNode\":35,\"innovation\":350009,\"weight\":0.16207945403307503,\"enabled\":false},{\"inNode\":22,\"outNode\":35,\"innovation\":350022,\"weight\":-0.23005958076732802,\"enabled\":false},{\"inNode\":50,\"outNode\":35,\"innovation\":350050,\"weight\":0.4135826650005019,\"enabled\":true}]},{\"inputId\":0,\"id\":36,\"type\":\"OUTPUT\",\"backConnections\":[{\"inNode\":7,\"outNode\":36,\"innovation\":360007,\"weight\":-0.4163747836760261,\"enabled\":false},{\"inNode\":11,\"outNode\":36,\"innovation\":360011,\"weight\":0.2392812432958664,\"enabled\":false},{\"inNode\":17,\"outNode\":36,\"innovation\":360017,\"weight\":0.27545912091125324,\"enabled\":false},{\"inNode\":25,\"outNode\":36,\"innovation\":360025,\"weight\":0.9381774086736617,\"enabled\":true}]},{\"inputId\":0,\"id\":50,\"type\":\"HIDDEN\",\"backConnections\":[{\"inNode\":22,\"outNode\":50,\"innovation\":500022,\"weight\":0.9663136477135805,\"enabled\":true}]}]\n",
                NodeFunctionsCreator.linearUnit());
        TicTacToe ticTacToe = new TicTacToe();
        while (ticTacToe != null && !ticTacToe.getPossibleMoves().isEmpty()) {
            int[] board = ticTacToe.getBoard();
            int move = TicTacToeTrainer.evaluateIn27Out9(geno, board);
            ticTacToe = ticTacToe.makeMove(move);
            if (ticTacToe == null) break;
            System.out.println(ticTacToe);
            ticTacToe = ticTacToe.makeRandomMove();
            System.out.println(ticTacToe);
        }
        System.out.println(ticTacToe);
    }
}
